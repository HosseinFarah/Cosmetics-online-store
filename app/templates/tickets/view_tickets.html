{% extends "base.html" %} {% block content %}
<div class="container">
  <h2>Your Tickets</h2>
  <a href="{{ url_for('tickets.create_ticket') }}" class="btn btn-primary"
    >Create Ticket</a
  >
  <div class="row d-flex justify-content-center">
    <div class="col-md-8">
      <table class="table table-striped">
        <thead>
          <tr>
            <th>Ticket ID</th>
            <th>User</th>
            <th>Title</th>
            <th>Status</th>
            <th>Actions</th>
          </tr>
        </thead>
        <tbody>
          {% for ticket in tickets %}
          <tr class="{% if ticket.status == 'resolved' %}table-success{% elif ticket.status == 'in_progress' %}table-warning{% else %}table-danger{% endif %}">
            <td>{{ ticket.id }}</td>
            <td>{{ ticket.user.firstname }} {{ ticket.user.lastname }}</td>
            <td>{{ ticket.title }}</td>
            <td>{{ ticket.status }}</td>
            <td>
              <a
                href="{{ url_for('tickets.view_ticket', ticket_id=ticket.id) }}"
                class="btn btn-primary"
                data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="View Ticket"
                ><i class="fas fa-eye"></i></a>
              {% if ticket.status != 'resolved' or current_user.is_administrator() %}
              <a
                href="{{ url_for('tickets.update_ticket', ticket_id=ticket.id) }}"
                class="btn btn-warning"
                data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="Update Ticket"
                ><i class="fas fa-edit"></i></a>
              {% endif %}
              <a
                href="{{ url_for('tickets.delete_ticket', ticket_id=ticket.id) }}"
                class="btn btn-danger"
                onclick="return confirm('Are you sure you want to delete this ticket?')"
                data-bs-toggle="tooltip" data-bs-placement="top" data-bs-title="Delete Ticket"
                ><i class="fas fa-trash"></i></a>
            </td>
          </tr>

          {% endfor %}
        </tbody>
      </table>
    </div>
  </div>
</div>
{% endblock %}
